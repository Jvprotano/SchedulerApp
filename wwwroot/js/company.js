$(document).ready(function () {

    // Hide the address div if the company is virtual
    if ($('#IsVirtual').is(':checked')) {
        $('#addressDiv').hide();
    }

    var image = document.getElementById("uploadedImage");

    console.log(image.src)

    if (image.src == null || image.src == "" || image.src == window.location.href) {
        $('#divUploadedImage').hide();
    }

    if ($('#AutoGeneratedImage').is(':checked')) {
        $('#divBtnUploadImage').hide();
        $('#divUploadedImage').hide();

        $('#divMessageImage').show();
    }
    else {
        $('#divMessageImage').hide();
    }

});

// Show the address div if the company is not virtual
$('#IsVirtual').click(function () {
    if ($(this).is(':checked')) {
        $('#addressDiv').hide();
    } else {
        $('#addressDiv').show();
    }
});


$('#AutoGeneratedImage').click(function () {
    if ($(this).is(':checked')) {
        $('#divBtnUploadImage').hide();
        $('#divUploadedImage').hide();
        $('#divMessageImage').show();
    } else {
        $('#divBtnUploadImage').show();
        $('#divUploadedImage').show();
        $('#divMessageImage').hide();
    }
});

// Triggered when a file is selected
$('#uploadInput').change(function () {
    $('#divUploadedImage').show();
    readURL(this);
});

// Function to read and display the selected image
function readURL(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
            $('#uploadedImage').attr('src', e.target.result);
        };

        reader.readAsDataURL(input.files[0]);
    }
}

document.getElementById("uploadButton").addEventListener("click", function () {
    document.getElementById("uploadInput").click();
});


var serviceIndex = 0;

$('#addService').click(function () {
    var serviceDetails = `
    <div class="service" id="service${serviceIndex}">
        <label>Service Name:</label>
        <input type="text" name="ServicesOffered[${serviceIndex}].Name">

        <label>Price:</label>
        <input type="number" min="1" step="any" name="ServicesOffered[${serviceIndex}].Price">

        <label>Duration:</label>
        <input type="text" name="ServicesOffered[${serviceIndex}].Duration"  id="durationInput" pattern="^([0-1]?[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$" placeholder="00:00:00" required>
        
        <button type="button" class="btn btn-sm btn-danger">Remove</button>
    </div>
`;

    $('#serviceDetails').append(serviceDetails);
    serviceIndex++;
});

$('#SelectedExistingNames').change(function () {
    var selectedService = $(this).find('option:selected').text();
    var serviceDetails = `
    <div class="service" id="service${serviceIndex}">
        <label>Service Name:</label>
        <input type="text" name="ServicesOffered[${serviceIndex}].Name" value="${selectedService}">

        <label>Price:</label>
        <input type="number" min="1" step="any" name="ServicesOffered[${serviceIndex}].Price">

        <label>Duration:</label>
        <input type="text" name="ServicesOffered[${serviceIndex}].Duration"  id="durationInput" pattern="^([0-1]?[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$" placeholder="00:00:00" required>
        
        <button type="button" class="btn btn-sm btn-danger">Remove</button>
    </div>
`;

    $('#serviceDetails').append(serviceDetails);
    serviceIndex++;
});

$('#serviceDetails').on('click', '.btn-danger', function () {
    $(this).closest('.service').remove();
});